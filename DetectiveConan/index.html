<!-- DetectiveConan-html-14122025-[Restored-Picker] -->
<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>名探偵コナン - 20nxskypqz</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Niramit:wght@400;700&display=swap" rel="stylesheet" />

  <!-- Material Symbols -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@40,400,0,0&icon_names=menu,close,light_mode,dark_mode,arrow_drop_down,abc,table_view" />
  <style>
    .material-symbols-outlined{font-variation-settings:'FILL' 0,'wght' 400,'GRAD' 0,'opsz' 40; font-family:'Material Symbols Outlined' !important;}
    
    /* --- Iframe Container Styling --- */
    .sheet-frame-container {
      position: relative;
      width: 100%;
      height: 85vh; 
      overflow: hidden; 
      background: #fff;
      border-radius: 8px;
      border: 1px solid #e0e0e0;
      box-shadow: 0 4px 6px rgba(0,0,0,0.05);
    }

    .sheet-iframe {
      width: 100%;
      height: calc(100% + 35px); /* ดันขอบล่าง */
      border: none;
      display: block;
      margin-top: -2px;
    }

    /* --- Dark Mode Hack for Iframe --- */
    body.dark-mode .sheet-frame-container {
      border-color: #333;
      background: #000;
    }
    body.dark-mode .sheet-iframe {
      filter: invert(0.9) hue-rotate(180deg) contrast(0.85);
    }

    /* --- Season Picker Dropdown Styles --- */
    .season-picker {
      position: relative; /* เพื่อให้ dropdown อ้างอิงตำแหน่งได้ */
      z-index: 100;
    }
    
    .season-pill {
      cursor: pointer;
      user-select: none;
      transition: background-color 0.2s;
    }
    .season-pill:hover {
      background-color: #f0f0f0;
    }
    body.dark-mode .season-pill:hover {
      background-color: #2a2a2a;
    }

    /* กล่อง Dropdown */
    .season-dropdown-menu {
      position: absolute;
      top: 100%;
      left: 50%;
      transform: translateX(-50%);
      margin-top: 8px;
      background: var(--card);
      border: 1px solid #ddd;
      border-radius: 8px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
      min-width: 200px;
      overflow: hidden;
      display: none; /* ซ่อนไว้ก่อน */
    }
    
    body.dark-mode .season-dropdown-menu {
      border-color: #444;
      background: #1e1e1e;
    }

    .season-dropdown-menu.show {
      display: block;
      animation: fadeIn 0.2s ease;
    }

    .season-option {
      display: block;
      width: 100%;
      padding: 10px 16px;
      text-align: left;
      background: none;
      border: none;
      color: var(--ink);
      font-family: inherit;
      font-size: 1rem;
      cursor: pointer;
      border-bottom: 1px solid #eee;
    }
    .season-option:last-child { border-bottom: none; }
    .season-option:hover { background-color: rgba(0,0,0,0.05); }
    body.dark-mode .season-option:hover { background-color: rgba(255,255,255,0.05); }
    body.dark-mode .season-option { border-bottom-color: #333; }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateX(-50%) translateY(-10px); }
      to { opacity: 1; transform: translateX(-50%) translateY(0); }
    }

  </style>

  <link rel="stylesheet" href="/20nxskypqz/styles.css" />
</head>
<body class="light-mode">
  <div data-include="/20nxskypqz/shared/header.html"></div>
  <div data-include="/20nxskypqz/shared/side-menu.html"></div>

  <main class="content" style="max-width: 100%; padding: 0 10px;">
    <section class="hero">
      <h1 class="hero-title">名探偵コナン</h1>
      <h3 style="margin-top:-6px;">Detective Conan Episode List</h3>
    </section>

    <!-- Season Picker (Dropdown) -->
    <div class="season-picker" style="max-width: 1100px; margin: 0 auto 16px;">
      <!-- ปุ่มหน้าตาเดิม -->
      <div class="season-pill" id="seasonTrigger" role="button" tabindex="0">
        <span class="material-symbols-outlined">arrow_drop_down</span>
        <strong id="currentSeasonText">Season Picker</strong>
      </div>

      <!-- รายการตัวเลือก (เพิ่ม Sheet ID อื่นๆ ที่นี่) -->
      <div class="season-dropdown-menu" id="seasonDropdown">
        <button class="season-option" data-sheet-id="1N4GEfiPqnAG8zZuBdpt0AnaD433YD3Qep7Mayop08qQ">Main List (All)</button>
        <!-- ตัวอย่างปุ่มสำหรับ Sheet ถัดไป -->
        <!-- <button class="season-option" data-sheet-id="ANOTHER_SHEET_ID">Season 26-30</button> -->
      </div>
    </div>

    <!-- Iframe Container -->
    <div class="card" style="padding: 0; overflow: hidden; border: none; background: transparent; box-shadow: none;">
      <div class="sheet-frame-container">
        <iframe 
          id="sheetFrame"
          class="sheet-iframe"
          src=""
          title="Detective Conan List">
        </iframe>
      </div>
    </div>

  </main>

  <div data-include="/20nxskypqz/shared/footer.html"></div>
  <script src="/20nxskypqz/script.js"></script>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const trigger = document.getElementById('seasonTrigger');
      const dropdown = document.getElementById('seasonDropdown');
      const iframe = document.getElementById('sheetFrame');
      const currentText = document.getElementById('currentSeasonText');
      const options = document.querySelectorAll('.season-option');

      // Default Sheet ID
      const defaultSheetId = '1N4GEfiPqnAG8zZuBdpt0AnaD433YD3Qep7Mayop08qQ';
      
      // ฟังก์ชันโหลด iframe
      function loadSheet(sheetId) {
        const url = `https://docs.google.com/spreadsheets/d/${sheetId}/preview?rm=minimal&widget=false&headers=false`;
        iframe.src = url;
      }

      // โหลดครั้งแรก
      loadSheet(defaultSheetId);

      // Toggle Dropdown
      trigger.addEventListener('click', (e) => {
        e.stopPropagation();
        dropdown.classList.toggle('show');
        // หมุนลูกศร (ถ้ามี class rotate ใน css global หรือจะเพิ่ม style inline ก็ได้)
        const icon = trigger.querySelector('.material-symbols-outlined');
        if (dropdown.classList.contains('show')) {
          icon.style.transform = 'rotate(180deg)';
        } else {
          icon.style.transform = 'rotate(0deg)';
        }
      });

      // Handle Option Click
      options.forEach(btn => {
        btn.addEventListener('click', () => {
          const sheetId = btn.getAttribute('data-sheet-id');
          if (sheetId) {
            loadSheet(sheetId);
            currentText.textContent = btn.textContent; // เปลี่ยนข้อความปุ่มเป็นชื่อชีตที่เลือก
            dropdown.classList.remove('show'); // ปิด dropdown
            
            // Reset ลูกศร
            const icon = trigger.querySelector('.material-symbols-outlined');
            icon.style.transform = 'rotate(0deg)';
          }
        });
      });

      // Close dropdown when clicking outside
      document.addEventListener('click', (e) => {
        if (!trigger.contains(e.target) && !dropdown.contains(e.target)) {
          dropdown.classList.remove('show');
          const icon = trigger.querySelector('.material-symbols-outlined');
          icon.style.transform = 'rotate(0deg)';
        }
      });
    });
  </script>
</body>
</html>